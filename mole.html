<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Kiss-a-Mole üòò</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Quicksand:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * { box-sizing: border-box; touch-action: manipulation; -webkit-tap-highlight-color: transparent; }
        body, html {
            height: 100%; width: 100%; margin: 0; padding: 0; overflow: hidden;
            font-family: 'Quicksand', sans-serif;
            background: linear-gradient(135deg, #a7f3d0 0%, #6ee7b7 100%); /* Fresh Green Grass */
        }

        /* --- UI ELEMENTS --- */
        .back-btn {
            position: absolute; top: 20px; left: 20px; z-index: 50;
            background: white; padding: 8px 20px; border-radius: 99px;
            color: #ec4899; font-weight: bold; text-decoration: none;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .header {
            position: absolute; top: 8%; width: 100%; text-align: center; pointer-events: none;
        }
        h1 {
            font-family: 'Pacifico', cursive; color: #065f46;
            font-size: clamp(2.5rem, 6vw, 4rem); 
            text-shadow: 2px 2px 0 rgba(255,255,255,0.4);
        }
        .scoreboard {
            background: white; padding: 8px 24px; border-radius: 20px;
            display: inline-flex; gap: 20px; margin-top: 10px;
            font-weight: bold; color: #065f46; font-size: 1.2rem;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        /* --- GAME GRID --- */
        .game-container {
            position: absolute; bottom: 5%; left: 50%;
            transform: translateX(-50%);
            width: 95%; max-width: 600px;
            /* Aspect ratio approx 3x3 square-ish */
            height: 60vh;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 10px;
            padding: 10px;
        }

        /* --- THE HOLE --- */
        .hole {
            position: relative;
            overflow: hidden; /* Hide mole when down */
            display: flex; justify-content: center;
        }
        
        /* Dirt Mound Graphics */
        .dirt-back {
            position: absolute; bottom: 0; width: 80%; height: 30%;
            background: #3f2e00; border-radius: 50%; z-index: 1;
            box-shadow: inset 0 5px 10px rgba(0,0,0,0.5);
        }
        .dirt-front {
            position: absolute; bottom: -10px; width: 100%; height: 40%;
            background: url('https://www.transparenttextures.com/patterns/dirt.png'), #5c4033;
            border-radius: 20px; z-index: 10;
        }

        /* --- THE MOLE (Character) --- */
        .mole {
            position: absolute;
            bottom: 0; /* Start at floor of hole */
            width: 70%;
            height: 80%;
            background-size: cover;
            background-position: center;
            border-radius: 50% 50% 0 0; /* Rounded top */
            z-index: 2;
            transform: translateY(100%); /* Hidden by default */
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            border: 3px solid white;
        }
        
        .mole.up { transform: translateY(10%); /* Pop up */ }
        .mole.hit { filter: brightness(1.2) sepia(0.2); transform: translateY(10%) scale(0.9); }

        /* Specific Backgrounds via Inline Style in JS, but defaults here */
        .mole-him { background-image: url('hugimages/himblue.jpg'); border-color: #3b82f6; }
        .mole-her { background-image: url('hugimages/herpink.jpg'); border-color: #ec4899; }
        .mole-bad { 
            background-color: #333; 
            background-image: url('https://cdn-icons-png.flaticon.com/512/159/159469.png'); /* Broken Heart Icon */
            background-size: 60%; background-repeat: no-repeat;
            border-color: #ef4444; 
        }

        /* --- PARTICLES --- */
        .kiss-mark {
            position: absolute; font-size: 2rem; pointer-events: none; z-index: 20;
            animation: floatKiss 0.8s ease-out forwards;
        }
        @keyframes floatKiss { to { transform: translateY(-50px) scale(1.5); opacity: 0; } }

        /* --- SCREENS --- */
        .screen-overlay {
            position: absolute; inset: 0; background: rgba(255,255,255,0.6); backdrop-filter: blur(5px);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            z-index: 50; transition: opacity 0.3s;
        }
        .screen-overlay.hidden { opacity: 0; pointer-events: none; display: none; }

        .btn {
            background: #ec4899; color: white; padding: 15px 40px;
            border-radius: 99px; font-weight: bold; font-size: 1.5rem;
            margin-top: 20px; cursor: pointer; border: 4px solid white;
            box-shadow: 0 8px 15px rgba(236, 72, 153, 0.3);
            transition: transform 0.1s;
        }
        .btn:active { transform: scale(0.95); }

    </style>
</head>
<body>

    <a href="index.html" class="back-btn">‚¨Ö Back</a>

    <div class="header">
        <h1>Kiss-a-Mole</h1>
        <div class="scoreboard">
            <span>Score: <span id="score">0</span></span>
            <span>Time: <span id="time">30</span>s</span>
        </div>
    </div>

    <!-- GAME BOARD -->
    <div class="game-container" id="game-grid">
        <!-- 9 Holes generated by JS -->
    </div>

    <!-- START SCREEN -->
    <div id="start-screen" class="screen-overlay">
        <h2 class="font-pacifico text-5xl text-pink-600 mb-2">Ready to Kiss?</h2>
        <p class="text-gray-700 font-bold text-lg mb-6 max-w-xs text-center">
            Tap us when we pop up! üòò<br>Avoid the Broken Heart üíî
        </p>
        <button onclick="startGame()" class="btn">Start Game ‚ñ∂Ô∏è</button>
    </div>

    <!-- GAME OVER SCREEN -->
    <div id="game-over-screen" class="screen-overlay hidden">
        <h2 class="font-pacifico text-5xl text-purple-600 mb-2">Time's Up!</h2>
        <p class="text-gray-700 font-bold text-xl mb-4">Total Kisses: <span id="final-score" class="text-pink-500">0</span></p>
        <button onclick="startGame()" class="btn">Play Again üîÑ</button>
    </div>

    <script>
        const grid = document.getElementById('game-grid');
        const scoreEl = document.getElementById('score');
        const timeEl = document.getElementById('time');
        const finalScoreEl = document.getElementById('final-score');
        const startScreen = document.getElementById('start-screen');
        const endScreen = document.getElementById('game-over-screen');

        let holes = [];
        let lastHole;
        let timeUp = false;
        let score = 0;
        let timeLeft = 30;
        let timerInterval;

        // Initialize Holes
        function createHoles() {
            grid.innerHTML = '';
            for (let i = 0; i < 9; i++) {
                const hole = document.createElement('div');
                hole.classList.add('hole');
                
                // Back of dirt
                const dirtBack = document.createElement('div');
                dirtBack.classList.add('dirt-back');
                
                // The Mole Element
                const mole = document.createElement('div');
                mole.classList.add('mole');
                // Use mousedown/touchstart for faster response
                mole.addEventListener('mousedown', (e) => bonk(e, mole));
                mole.addEventListener('touchstart', (e) => { e.preventDefault(); bonk(e, mole); });
                
                // Front of dirt
                const dirtFront = document.createElement('div');
                dirtFront.classList.add('dirt-front');

                hole.appendChild(dirtBack);
                hole.appendChild(mole);
                hole.appendChild(dirtFront);
                grid.appendChild(hole);
                holes.push(mole);
            }
        }

        // --- GAME LOGIC ---
        function randomTime(min, max) {
            return Math.round(Math.random() * (max - min) + min);
        }

        function randomHole(holes) {
            const idx = Math.floor(Math.random() * holes.length);
            const hole = holes[idx];
            if (hole === lastHole) return randomHole(holes);
            lastHole = hole;
            return hole;
        }

        function peep() {
            const time = randomTime(500, 1000); // Speed
            const mole = randomHole(holes);
            
            // Randomly decide type: Him, Her, or Bad (Rare)
            const roll = Math.random();
            mole.className = 'mole'; // Reset classes
            
            let type = 'good';
            if (roll < 0.45) {
                mole.classList.add('mole-him');
            } else if (roll < 0.9) {
                mole.classList.add('mole-her');
            } else {
                mole.classList.add('mole-bad');
                type = 'bad';
            }

            mole.dataset.type = type;
            mole.classList.add('up');

            setTimeout(() => {
                mole.classList.remove('up');
                if (!timeUp) peep();
            }, time);
        }

        function startGame() {
            score = 0;
            timeLeft = 30;
            scoreEl.textContent = 0;
            timeEl.textContent = 30;
            timeUp = false;
            
            startScreen.classList.add('hidden');
            endScreen.classList.add('hidden');
            
            peep();
            
            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                timeLeft--;
                timeEl.textContent = timeLeft;
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    timeUp = true;
                    gameOver();
                }
            }, 1000);
        }

        function bonk(e, mole) {
            if (!e.isTrusted) return; // Cheater check
            if (!mole.classList.contains('up')) return; // Can't hit if hidden

            mole.classList.remove('up'); // Hide immediately
            
            if (mole.dataset.type === 'bad') {
                score -= 50;
                showFeedback(e.clientX || e.touches[0].clientX, e.clientY || e.touches[0].clientY, 'üíî');
            } else {
                score += 10;
                showFeedback(e.clientX || e.touches[0].clientX, e.clientY || e.touches[0].clientY, 'üíã');
            }
            
            if (score < 0) score = 0;
            scoreEl.textContent = score;
        }

        function showFeedback(x, y, emoji) {
            const el = document.createElement('div');
            el.innerText = emoji;
            el.classList.add('kiss-mark');
            el.style.left = x + 'px';
            el.style.top = y + 'px';
            document.body.appendChild(el);
            setTimeout(() => el.remove(), 800);
        }

        function gameOver() {
            finalScoreEl.textContent = score;
            endScreen.classList.remove('hidden');
        }

        // Init
        createHoles();

    </script>
</body>
</html>